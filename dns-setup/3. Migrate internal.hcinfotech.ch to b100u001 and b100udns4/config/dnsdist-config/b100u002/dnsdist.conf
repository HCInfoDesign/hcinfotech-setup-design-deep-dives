-- dnsdist configuration file, an example can be found in /usr/share/doc/dnsdist/examples/

-- disable security status polling via DNS
setSecurityPollSuffix("")

setACL('10.0.0.0/8')

addLocal('0.0.0.0', {reusePort=true})

newServer({address='10.1.50.32:5300', checkName='b100u002.internal.hcinfotech.ch', pool='internal'})
newServer({address='10.1.50.33:5300', checkName='b100u002.internal.hcinfotech.ch', pool='internal'})
newServer({address='10.1.50.34:5300', checkName='b100u002.internal.hcinfotech.ch', pool='internal'})

newServer({address='10.1.51.12:53', checkName='b100udns1.a.internal.hcinfotech.ch', pool='a-internal'})

newServer({address='10.1.50.13:53', checkName='b100udns4.b.internal.hcinfotech.ch', pool='b-internal'})

newServer({address='1.1.1.1:53', checkName='google.com', pool='external'})
newServer({address='1.0.0.1:53', checkName='google.com', pool='external'})

addAction(RegexRule("\\.a\\.internal\\."), PoolAction("a-internal"))
addAction(RegexRule("\\.b\\.internal\\."), PoolAction("b-internal"))
addAction(RegexRule("\\.internal\\."), PoolAction("internal"))
addAction(RegexRule("\\.51\\.1\\.10\\."), PoolAction("a-internal"))
addAction(RegexRule("\\.50\\.1\\.10\\."), PoolAction("internal"))

addAction(AllRule(), PoolAction("external"))

setServerPolicy(chashed)

controlSocket('127.0.0.1:5199')
setKey("Gl3OxmpFZINdzeIPHBRm3LxOkNPBtBebR7VacS3mhho=")

